<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåü –•—Ä–æ–Ω–∏–∫–∏ –ê–≤–≥–∞—Ä–∞ | –ú–∞–≥–∞–∑–∏–Ω</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c0c1d 0%, #1a1a3e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .logo {
            font-size: 40px;
            margin-bottom: 10px;
            color: #ffd700;
        }

        .title {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        /* –ë–∞–ª–∞–Ω—Å —Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º */
        .balance-section {
            background: rgba(30, 60, 114, 0.5);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .balance-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .balance-info h3 {
            font-size: 14px;
            color: #a0c8ff;
            margin-bottom: 5px;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* –ö–Ω–æ–ø–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
        .topup-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .topup-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .topup-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }

        .topup-amount {
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .topup-price {
            font-size: 12px;
            color: #aaa;
            margin-top: 5px;
        }

        /* –£—Å–ª—É–≥–∏ */
        .service-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .service-name {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }

        .service-price {
            font-size: 22px;
            font-weight: bold;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .service-desc {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-buy {
            background: linear-gradient(90deg, #ff6b6b, #ffd700);
            color: #000;
        }

        .btn-buy:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .btn-buy:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-chat {
            background: rgba(59, 130, 246, 0.8);
            color: white;
            margin-top: 10px;
        }

        .btn-chat:hover {
            background: rgba(59, 130, 246, 1);
        }

        /* –ó–∞–∫–∞–∑—ã */
        .orders-section {
            margin-top: 30px;
        }

        .order-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .order-service {
            font-weight: bold;
            font-size: 16px;
        }

        .order-id {
            font-size: 11px;
            color: #aaa;
            font-family: monospace;
        }

        .order-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 5px;
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border-left-color: #ffc107;
        }

        .status-confirmed {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border-left-color: #4caf50;
        }

        .status-rejected {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border-left-color: #f44336;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 15px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="logo">üåü</div>
            <h1 class="title">–•–†–û–ù–ò–ö–ò –ê–í–ì–ê–†–ê</h1>
            <p id="userInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>

        <!-- –ë–∞–ª–∞–Ω—Å –∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ -->
        <div class="balance-section">
            <div class="balance-row">
                <div class="balance-info">
                    <h3>–í–ê–® –ë–ê–õ–ê–ù–°</h3>
                    <div class="balance-amount">
                        <span id="balanceValue">150</span>
                        <span>‚≠ê</span>
                    </div>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 12px; color: #a0c8ff; margin-bottom: 5px;">
                        –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å:
                    </div>
                    <div class="topup-grid">
                        <div class="topup-btn" onclick="showPaymentModal(50)">
                            <div class="topup-amount">+50 ‚≠ê</div>
                            <div class="topup-price">100 —Ä—É–±</div>
                        </div>
                        <div class="topup-btn" onclick="showPaymentModal(100)">
                            <div class="topup-amount">+100 ‚≠ê</div>
                            <div class="topup-price">180 —Ä—É–±</div>
                        </div>
                        <div class="topup-btn" onclick="showPaymentModal(200)">
                            <div class="topup-amount">+200 ‚≠ê</div>
                            <div class="topup-price">350 —Ä—É–±</div>
                        </div>
                        <div class="topup-btn" onclick="showPaymentModal(500)">
                            <div class="topup-amount">+500 ‚≠ê</div>
                            <div class="topup-price">800 —Ä—É–±</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –£—Å–ª—É–≥–∏ -->
        <div class="service-card">
            <div class="service-header">
                <div class="service-name">üõ°Ô∏è –î–µ—Ñ –æ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞</div>
            </div>
            <div class="service-desc">
                –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–π—Å—Ç–≤–∏–π –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å—Ä–æ–∫
            </div>
            
            <div style="margin: 15px 0;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span>1 –¥–µ–Ω—å –∑–∞—â–∏—Ç—ã</span>
                    <div class="service-price">15 ‚≠ê</div>
                </div>
                <button class="btn btn-buy" onclick="buyService('def-1-day', 15, '1 –¥–µ–Ω—å –∑–∞—â–∏—Ç—ã')">
                    üõí –ö—É–ø–∏—Ç—å
                </button>
            </div>

            <div style="margin: 15px 0;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span>1 –Ω–µ–¥–µ–ª—è –∑–∞—â–∏—Ç—ã</span>
                    <div class="service-price">50 ‚≠ê</div>
                </div>
                <button class="btn btn-buy" onclick="buyService('def-1-week', 50, '1 –Ω–µ–¥–µ–ª—è –∑–∞—â–∏—Ç—ã')">
                    üõí –ö—É–ø–∏—Ç—å
                </button>
            </div>

            <div style="margin: 15px 0;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span>1 –º–µ—Å—è—Ü –∑–∞—â–∏—Ç—ã</span>
                    <div class="service-price">100 ‚≠ê</div>
                </div>
                <button class="btn btn-buy" onclick="buyService('def-1-month', 100, '1 –º–µ—Å—è—Ü –∑–∞—â–∏—Ç—ã')">
                    üõí –ö—É–ø–∏—Ç—å
                </button>
            </div>
        </div>

        <div class="service-card">
            <div class="service-header">
                <div class="service-name">üîç –ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö</div>
                <div class="service-price">75 ‚≠ê</div>
            </div>
            <div class="service-desc">
                –ì–ª—É–±–æ–∫–∏–π –ø–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏–∑ –ª—é–±–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            </div>
            <button class="btn btn-buy" onclick="buyService('data-search', 75, '–ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö')">
                üõí –ö—É–ø–∏—Ç—å
            </button>
        </div>

        <div class="service-card" style="opacity: 0.5;">
            <div class="service-header">
                <div class="service-name">‚ö†Ô∏è –£–≥—Ä–æ–∑—ã</div>
                <div style="color: #f44336; font-size: 12px;">–ù–ï–î–û–°–¢–£–ü–ù–û</div>
            </div>
            <div class="service-desc">
                –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏ —É–≥—Ä–æ–∑
            </div>
            <button class="btn btn-buy" disabled>
                üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
            </button>
        </div>

        <!-- –ú–æ–∏ –∑–∞–∫–∞–∑—ã -->
        <div class="orders-section">
            <h3 style="margin-bottom: 15px; color: #4fc3f7;">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h3>
            <div id="ordersList">
                <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                <div style="text-align: center; padding: 30px; color: #666;">
                    –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤
                </div>
            </div>
        </div>

        <!-- –ß–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º -->
        <div style="margin-top: 30px; text-align: center;">
            <button class="btn btn-chat" onclick="openSellerChat()">
                üí¨ –ß–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-title">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</div>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 48px; color: #ffd700;" id="modalStars">+50 ‚≠ê</div>
                <div style="color: #aaa; margin-top: 10px;" id="modalPrice">–°—Ç–æ–∏–º–æ—Å—Ç—å: 100 —Ä—É–±</div>
            </div>

            <div style="margin: 20px 0;">
                <div style="font-size: 14px; color: #aaa; margin-bottom: 10px;">
                    –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:
                </div>
                
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <button class="btn" style="background: #333; color: white;" onclick="processPayment('crypto')">
                        üíé –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ (USDT)
                    </button>
                    <button class="btn" style="background: #0077ff; color: white;" onclick="processPayment('card')">
                        üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
                    </button>
                    <button class="btn" style="background: #ff9500; color: white;" onclick="processPayment('qiwi')">
                        üß° QIWI –ö–æ—à–µ–ª–µ–∫
                    </button>
                </div>
            </div>

            <button class="btn" style="background: rgba(255,255,255,0.1); color: white; margin-top: 15px;" 
                    onclick="closeModal('paymentModal')">
                –û—Ç–º–µ–Ω–∞
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫–∞–∑–∞ -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <div class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</div>
            
            <div style="margin: 20px 0;">
                <div style="margin-bottom: 10px;">
                    <strong>–£—Å–ª—É–≥–∞:</strong> <span id="modalServiceName"></span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> <span id="modalServicePrice"></span> ‚≠ê
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>–í–∞—à –±–∞–ª–∞–Ω—Å:</strong> <span id="modalUserBalance"></span> ‚≠ê
                </div>
                
                <div id="modalBalanceWarning" style="display: none; background: rgba(244,67,54,0.1); padding: 10px; border-radius: 8px; margin: 15px 0;">
                    ‚ùó –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.
                </div>
            </div>

            <button class="btn btn-buy" onclick="confirmPurchase()" id="confirmBtn">
                ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–∫—É–ø–∫—É
            </button>
            
            <button class="btn" style="background: rgba(255,255,255,0.1); color: white; margin-top: 10px;" 
                    onclick="closeModal('orderModal')">
                –û—Ç–º–µ–Ω–∞
            </button>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="notificationContainer"></div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let userBalance = 150;
        let currentOrders = [];
        let selectedService = null;
        let selectedTopupAmount = 0;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function initApp() {
            tg.ready();
            tg.expand();
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe?.user;
            if (user) {
                const name = user.first_name || user.username || '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å';
                document.getElementById('userInfo').textContent = `–ü—Ä–∏–≤–µ—Ç, ${name}!`;
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadBalance();
            loadOrders();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            updateMainButton();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞
        function loadBalance() {
            const saved = localStorage.getItem('augar_balance_v2');
            if (saved) {
                userBalance = parseInt(saved);
                document.getElementById('balanceValue').textContent = userBalance;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function saveBalance() {
            localStorage.setItem('augar_balance_v2', userBalance.toString());
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤
        function loadOrders() {
            const saved = localStorage.getItem('augar_orders_v2');
            if (saved) {
                currentOrders = JSON.parse(saved);
                updateOrdersList();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
        function saveOrders() {
            localStorage.setItem('augar_orders_v2', JSON.stringify(currentOrders));
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
        function updateMainButton() {
            tg.MainButton.setParams({
                text: `–ë–∞–ª–∞–Ω—Å: ${userBalance} –∑–≤`,
                color: '#1e3c72',
                text_color: '#ffffff'
            });
            tg.MainButton.show();
        }
        
        // –ü–æ–∫—É–ø–∫–∞ —É—Å–ª—É–≥–∏
        function buyService(serviceId, price, serviceName) {
            selectedService = { id: serviceId, price: price, name: serviceName };
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
            const canBuy = userBalance >= price;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('modalServiceName').textContent = serviceName;
            document.getElementById('modalServicePrice').textContent = price;
            document.getElementById('modalUserBalance').textContent = userBalance;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            const warning = document.getElementById('modalBalanceWarning');
            const confirmBtn = document.getElementById('confirmBtn');
            
            if (canBuy) {
                warning.style.display = 'none';
                confirmBtn.disabled = false;
                confirmBtn.innerHTML = '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–∫—É–ø–∫—É';
            } else {
                warning.style.display = 'block';
                confirmBtn.disabled = true;
                confirmBtn.innerHTML = '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            showModal('orderModal');
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏
        function confirmPurchase() {
            if (!selectedService) return;
            
            const { id, price, name } = selectedService;
            
            // –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
            const orderId = 'ORD_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5).toUpperCase();
            const order = {
                id: orderId,
                serviceId: id,
                serviceName: name,
                price: price,
                status: 'pending', // pending, confirmed, rejected, completed
                createdAt: new Date().toISOString(),
                customerId: tg.initDataUnsafe?.user?.id,
                customerName: tg.initDataUnsafe?.user?.first_name || tg.initDataUnsafe?.user?.username || '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å',
                customerUsername: tg.initDataUnsafe?.user?.username || null
            };
            
            // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ (—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ)
            userBalance -= price;
            saveBalance();
            updateBalanceDisplay();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑
            currentOrders.push(order);
            saveOrders();
            updateOrdersList();
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü—É
            const orderData = {
                action: 'new_order',
                orderId: orderId,
                service: name,
                price: price,
                customerId: order.customerId,
                customerName: order.customerName,
                customerUsername: order.customerUsername,
                timestamp: Date.now()
            };
            
            tg.sendData(JSON.stringify(orderData));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification(`‚úÖ –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω! ID: ${orderId}`, 'success');
            tg.HapticFeedback.notificationOccurred('success');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModal('orderModal');
            selectedService = null;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã (–∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞)
            setTimeout(() => {
                updateOrdersList();
            }, 2000);
        }
        
        // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function showPaymentModal(amount) {
            selectedTopupAmount = amount;
            
            const prices = {
                50: '100 —Ä—É–±',
                100: '180 —Ä—É–±',
                200: '350 —Ä—É–±',
                500: '800 —Ä—É–±'
            };
            
            document.getElementById('modalStars').textContent = `+${amount} ‚≠ê`;
            document.getElementById('modalPrice').textContent = `–°—Ç–æ–∏–º–æ—Å—Ç—å: ${prices[amount] || '—É—Ç–æ—á–Ω—è–π—Ç–µ'}`;
            
            showModal('paymentModal');
        }
        
        function processPayment(method) {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–ø–ª–∞—Ç—É –ø—Ä–æ–¥–∞–≤—Ü—É
            const paymentData = {
                action: 'payment_request',
                amount: selectedTopupAmount,
                method: method,
                customerId: tg.initDataUnsafe?.user?.id,
                customerName: tg.initDataUnsafe?.user?.first_name || tg.initDataUnsafe?.user?.username || '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å',
                timestamp: Date.now()
            };
            
            tg.sendData(JSON.stringify(paymentData));
            
            showNotification(`üì§ –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–ø–ª–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø—Ä–æ–¥–∞–≤—Ü—É. –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.`, 'info');
            closeModal('paymentModal');
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function updateBalanceDisplay() {
            document.getElementById('balanceValue').textContent = userBalance;
            updateMainButton();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
        function updateOrdersList() {
            const container = document.getElementById('ordersList');
            
            if (currentOrders.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 30px; color: #666;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</div>';
                return;
            }
            
            let html = '';
            currentOrders.forEach(order => {
                let statusText, statusClass;
                
                switch (order.status) {
                    case 'pending':
                        statusText = '‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è';
                        statusClass = 'status-pending';
                        break;
                    case 'confirmed':
                        statusText = '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –ø—Ä–æ–¥–∞–≤—Ü–æ–º';
                        statusClass = 'status-confirmed';
                        break;
                    case 'rejected':
                        statusText = '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω';
                        statusClass = 'status-rejected';
                        break;
                    case 'completed':
                        statusText = 'üéâ –ó–∞–≤–µ—Ä—à–µ–Ω';
                        statusClass = 'status-confirmed';
                        break;
                    default:
                        statusText = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ';
                        statusClass = 'status-pending';
                }
                
                const date = new Date(order.createdAt).toLocaleDateString('ru-RU');
                
                html += `
                    <div class="order-card">
                        <div class="order-header">
                            <div class="order-service">${order.serviceName}</div>
                            <div class="service-price">${order.price} ‚≠ê</div>
                        </div>
                        <div class="order-id">ID: ${order.id}</div>
                        <div class="order-status ${statusClass}">
                            ${statusText}
                        </div>
                        ${order.status === 'confirmed' ? `
                        <button class="btn btn-chat" onclick="startChat('${order.id}')" style="margin-top: 10px;">
                            üí¨ –û–±—Å—É–¥–∏—Ç—å –∑–∞–∫–∞–∑ —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º
                        </button>
                        ` : ''}
                        <div style="font-size: 11px; color: #666; margin-top: 8px;">
                            ${date}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // –ß–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º
        function openSellerChat() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
            const confirmedOrder = currentOrders.find(o => o.status === 'confirmed');
            
            if (confirmedOrder) {
                startChat(confirmedOrder.id);
            } else {
                showNotification('üí¨ –ß–∞—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –ø—Ä–æ–¥–∞–≤—Ü–æ–º', 'info');
            }
        }
        
        function startChat(orderId) {
            const chatData = {
                action: 'open_chat',
                orderId: orderId,
                customerId: tg.initDataUnsafe?.user?.id,
                timestamp: Date.now()
            };
            
            tg.sendData(JSON.stringify(chatData));
            showNotification('üí¨ –ß–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º –æ—Ç–∫—Ä—ã—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–æ—Ç–∞!', 'success');
        }
        
        // –†–∞–±–æ—Ç–∞ —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            // –¶–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            const colors = {
                'info': '#2196f3',
                'success': '#4caf50',
                'error': '#f44336',
                'warning': '#ff9800'
            };
            
            notification.style.borderLeftColor = colors[type] || colors.info;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (container.contains(notification)) {
                        container.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞, —Å—Ç–∞—Ç—É—Å–æ–≤)
        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'update_balance') {
                userBalance = event.data.balance;
                updateBalanceDisplay();
                saveBalance();
                showNotification(`‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω: ${userBalance} –∑–≤`, 'success');
            }
            
            if (event.data && event.data.type === 'order_update') {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
                const order = currentOrders.find(o => o.id === event.data.orderId);
                if (order) {
                    order.status = event.data.status;
                    saveOrders();
                    updateOrdersList();
                    
                    const statusMessages = {
                        'confirmed': '‚úÖ –í–∞—à –∑–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –ø—Ä–æ–¥–∞–≤—Ü–æ–º!',
                        'rejected': '‚ùå –ó–∞–∫–∞–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω. –°—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã.',
                        'completed': 'üéâ –ó–∞–∫–∞–∑ –∑–∞–≤–µ—Ä—à–µ–Ω!'
                    };
                    
                    if (statusMessages[event.data.status]) {
                        showNotification(statusMessages[event.data.status], 
                                       event.data.status === 'rejected' ? 'error' : 'success');
                        
                        if (event.data.status === 'rejected') {
                            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞
                            userBalance += order.price;
                            updateBalanceDisplay();
                            saveBalance();
                        }
                    }
                }
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
